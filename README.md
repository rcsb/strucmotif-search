[![Maven Central](https://maven-badges.herokuapp.com/maven-central/org.rcsb/strucmotif-search/badge.svg)](https://maven-badges.herokuapp.com/maven-central/org.rcsb/strucmotif-search)
[![Changelog](https://img.shields.io/badge/changelog--lightgrey.svg?style=flat)](https://github.com/rcsb/strucmotif-search/blob/master/CHANGELOG.md)

# Structural Motif Search
Biochemical and biological functions of proteins are the product of both the overall fold
of the polypeptide chain, and, typically, structural motifs made up of smaller numbers
of amino acids constituting a catalytic center or a binding site that may be remote from
one another in amino acid sequence. Detection of such structural motifs can provide valuable
insights into the function(s) of previously uncharacterized proteins.

![alt motifs](https://raw.githubusercontent.com/rcsb/strucmotif-search/master/motifs.png)

Technically, this remains an extremely challenging problem because of the size of the Protein
Data Bank (PDB) archive. We have developed a new approach that uses an inverted index strategy
capable of analyzing >180,000 PDB structures with unmatched speed. The efficiency of our 
inverted index method depends critically on identifying the small number of structures 
containing the query motif and ignoring most of the structures that are irrelevant. Our 
approach enables real-time retrieval and superposition of structural motifs, either extracted
from a reference structure or uploaded by the user.

## See it in Action
Structural motif searching is available as part of the [RCSB Advanced Search](https://www.rcsb.org/search/advanced/strucmotif) and [RCSB Mol* plugin](https://www.rcsb.org/3d-view). [Help documentation is available](https://www.rcsb.org/docs/search-and-browse/advanced-search/structure-motif-search).

## Performance
Current benchmark times to search in `185,541` PDB and `992,316` AlphaFold structures as of `3/4/22`, obtained on an instance with 6 cores and 64 
GB memory. All structure data is held in memory, inverted index data is read from an SSD.

### Allowing only Experimental/Archived Structures
| Motif                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        | Definition                                                                   | Found Assemblies | 'Paths' Time [ms] | 'Score' Time [ms] | Total Time [ms] |
|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------|------------------|-------------------|-------------------|-----------------|
| [Serine Protease](https://www.rcsb.org/search?request=%7B%22query%22%3A%7B%22type%22%3A%22group%22%2C%22logical_operator%22%3A%22and%22%2C%22nodes%22%3A%5B%7B%22type%22%3A%22terminal%22%2C%22service%22%3A%22strucmotif%22%2C%22parameters%22%3A%7B%22value%22%3A%7B%22entry_id%22%3A%224CHA%22%2C%22residue_ids%22%3A%5B%7B%22label_asym_id%22%3A%22B%22%2C%22struct_oper_id%22%3A%221%22%2C%22label_seq_id%22%3A42%7D%2C%7B%22label_asym_id%22%3A%22B%22%2C%22struct_oper_id%22%3A%221%22%2C%22label_seq_id%22%3A87%7D%2C%7B%22label_asym_id%22%3A%22C%22%2C%22struct_oper_id%22%3A%221%22%2C%22label_seq_id%22%3A47%7D%5D%7D%2C%22rmsd_cutoff%22%3A2%2C%22atom_pairing_scheme%22%3A%22ALL%22%2C%22exchanges%22%3A%5B%7B%22residue_id%22%3A%7B%22label_asym_id%22%3A%22B%22%2C%22struct_oper_id%22%3A%221%22%2C%22label_seq_id%22%3A42%7D%2C%22allowed%22%3A%5B%22HIS%22%5D%7D%2C%7B%22residue_id%22%3A%7B%22label_asym_id%22%3A%22B%22%2C%22struct_oper_id%22%3A%221%22%2C%22label_seq_id%22%3A87%7D%2C%22allowed%22%3A%5B%22ASP%22%5D%7D%2C%7B%22residue_id%22%3A%7B%22label_asym_id%22%3A%22C%22%2C%22struct_oper_id%22%3A%221%22%2C%22label_seq_id%22%3A47%7D%2C%22allowed%22%3A%5B%22SER%22%5D%7D%5D%7D%7D%5D%7D%2C%22return_type%22%3A%22assembly%22%2C%22request_options%22%3A%7B%22pager%22%3A%7B%22start%22%3A0%2C%22rows%22%3A25%7D%2C%22scoring_strategy%22%3A%22combined%22%2C%22sort%22%3A%5B%7B%22sort_by%22%3A%22score%22%2C%22direction%22%3A%22desc%22%7D%5D%7D%2C%22request_info%22%3A%7B%22src%22%3A%22ui%22%2C%22query_id%22%3A%2294392fddc4cac2e83939ea7b4a842f52%22%7D%7D)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | 4cha - His:B-42, Asp:B-87, Ser:C-47                                          | 4,869            | 838               | 38                | 912             |
| [Aminopeptidase](https://www.rcsb.org/search?request=%7B%22query%22%3A%7B%22type%22%3A%22group%22%2C%22logical_operator%22%3A%22and%22%2C%22nodes%22%3A%5B%7B%22type%22%3A%22terminal%22%2C%22service%22%3A%22strucmotif%22%2C%22parameters%22%3A%7B%22value%22%3A%7B%22entry_id%22%3A%221LAP%22%2C%22residue_ids%22%3A%5B%7B%22label_asym_id%22%3A%22A%22%2C%22struct_oper_id%22%3A%221%22%2C%22label_seq_id%22%3A250%7D%2C%7B%22label_asym_id%22%3A%22A%22%2C%22struct_oper_id%22%3A%221%22%2C%22label_seq_id%22%3A255%7D%2C%7B%22label_asym_id%22%3A%22A%22%2C%22struct_oper_id%22%3A%221%22%2C%22label_seq_id%22%3A273%7D%2C%7B%22label_asym_id%22%3A%22A%22%2C%22struct_oper_id%22%3A%221%22%2C%22label_seq_id%22%3A332%7D%2C%7B%22label_asym_id%22%3A%22A%22%2C%22struct_oper_id%22%3A%221%22%2C%22label_seq_id%22%3A334%7D%5D%7D%2C%22rmsd_cutoff%22%3A2%2C%22atom_pairing_scheme%22%3A%22ALL%22%2C%22exchanges%22%3A%5B%7B%22residue_id%22%3A%7B%22label_asym_id%22%3A%22A%22%2C%22struct_oper_id%22%3A%221%22%2C%22label_seq_id%22%3A250%7D%2C%22allowed%22%3A%5B%22LYS%22%5D%7D%2C%7B%22residue_id%22%3A%7B%22label_asym_id%22%3A%22A%22%2C%22struct_oper_id%22%3A%221%22%2C%22label_seq_id%22%3A255%7D%2C%22allowed%22%3A%5B%22ASP%22%5D%7D%2C%7B%22residue_id%22%3A%7B%22label_asym_id%22%3A%22A%22%2C%22struct_oper_id%22%3A%221%22%2C%22label_seq_id%22%3A273%7D%2C%22allowed%22%3A%5B%22ASP%22%5D%7D%2C%7B%22residue_id%22%3A%7B%22label_asym_id%22%3A%22A%22%2C%22struct_oper_id%22%3A%221%22%2C%22label_seq_id%22%3A332%7D%2C%22allowed%22%3A%5B%22ASP%22%5D%7D%2C%7B%22residue_id%22%3A%7B%22label_asym_id%22%3A%22A%22%2C%22struct_oper_id%22%3A%221%22%2C%22label_seq_id%22%3A334%7D%2C%22allowed%22%3A%5B%22GLU%22%5D%7D%5D%7D%7D%5D%7D%2C%22return_type%22%3A%22assembly%22%2C%22request_options%22%3A%7B%22pager%22%3A%7B%22start%22%3A0%2C%22rows%22%3A25%7D%2C%22scoring_strategy%22%3A%22combined%22%2C%22sort%22%3A%5B%7B%22sort_by%22%3A%22score%22%2C%22direction%22%3A%22desc%22%7D%5D%7D%2C%22request_info%22%3A%7B%22src%22%3A%22ui%22%2C%22query_id%22%3A%22f9ac5032bafa82602773f5b9c7809852%22%7D%7D)                                                                                                      | 1lap - Lys:A-250, Asp:A-255, Asp:A-273, Asp:A-332, Glu:A-334                 | 81               | 490               | 2                 | 511             |
| [Zinc Fingers](https://www.rcsb.org/search?request=%7B%22query%22%3A%7B%22type%22%3A%22group%22%2C%22logical_operator%22%3A%22and%22%2C%22nodes%22%3A%5B%7B%22type%22%3A%22terminal%22%2C%22service%22%3A%22strucmotif%22%2C%22parameters%22%3A%7B%22value%22%3A%7B%22entry_id%22%3A%221G2F%22%2C%22residue_ids%22%3A%5B%7B%22label_asym_id%22%3A%22F%22%2C%22struct_oper_id%22%3A%221%22%2C%22label_seq_id%22%3A7%7D%2C%7B%22label_asym_id%22%3A%22F%22%2C%22struct_oper_id%22%3A%221%22%2C%22label_seq_id%22%3A25%7D%2C%7B%22label_asym_id%22%3A%22F%22%2C%22struct_oper_id%22%3A%221%22%2C%22label_seq_id%22%3A29%7D%5D%7D%2C%22rmsd_cutoff%22%3A2%2C%22atom_pairing_scheme%22%3A%22ALL%22%2C%22exchanges%22%3A%5B%7B%22residue_id%22%3A%7B%22label_asym_id%22%3A%22F%22%2C%22struct_oper_id%22%3A%221%22%2C%22label_seq_id%22%3A7%7D%2C%22allowed%22%3A%5B%22CYS%22%5D%7D%2C%7B%22residue_id%22%3A%7B%22label_asym_id%22%3A%22F%22%2C%22struct_oper_id%22%3A%221%22%2C%22label_seq_id%22%3A25%7D%2C%22allowed%22%3A%5B%22HIS%22%5D%7D%2C%7B%22residue_id%22%3A%7B%22label_asym_id%22%3A%22F%22%2C%22struct_oper_id%22%3A%221%22%2C%22label_seq_id%22%3A29%7D%2C%22allowed%22%3A%5B%22HIS%22%5D%7D%5D%7D%7D%5D%7D%2C%22return_type%22%3A%22assembly%22%2C%22request_options%22%3A%7B%22pager%22%3A%7B%22start%22%3A0%2C%22rows%22%3A25%7D%2C%22scoring_strategy%22%3A%22combined%22%2C%22sort%22%3A%5B%7B%22sort_by%22%3A%22score%22%2C%22direction%22%3A%22desc%22%7D%5D%7D%2C%22request_info%22%3A%7B%22src%22%3A%22ui%22%2C%22query_id%22%3A%22a58d3ce5f6337c8a6bf6045ec903aba8%22%7D%7D)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | 1g2f - Cys:F-7 His:F-25 His:F-29                                             | 458              | 113               | 5                 | 135             |
| [Enolase Superfamily](https://www.rcsb.org/search?request=%7B%22query%22%3A%7B%22type%22%3A%22group%22%2C%22logical_operator%22%3A%22and%22%2C%22nodes%22%3A%5B%7B%22type%22%3A%22terminal%22%2C%22service%22%3A%22strucmotif%22%2C%22parameters%22%3A%7B%22value%22%3A%7B%22residue_ids%22%3A%5B%7B%22label_asym_id%22%3A%22A%22%2C%22struct_oper_id%22%3A%221%22%2C%22label_seq_id%22%3A162%7D%2C%7B%22label_asym_id%22%3A%22A%22%2C%22struct_oper_id%22%3A%221%22%2C%22label_seq_id%22%3A193%7D%2C%7B%22label_asym_id%22%3A%22A%22%2C%22struct_oper_id%22%3A%221%22%2C%22label_seq_id%22%3A219%7D%2C%7B%22label_asym_id%22%3A%22A%22%2C%22struct_oper_id%22%3A%221%22%2C%22label_seq_id%22%3A245%7D%2C%7B%22label_asym_id%22%3A%22A%22%2C%22struct_oper_id%22%3A%221%22%2C%22label_seq_id%22%3A295%7D%5D%2C%22entry_id%22%3A%222MNR%22%7D%2C%22rmsd_cutoff%22%3A2%2C%22atom_pairing_scheme%22%3A%22ALL%22%2C%22exchanges%22%3A%5B%7B%22residue_id%22%3A%7B%22label_asym_id%22%3A%22A%22%2C%22struct_oper_id%22%3A%221%22%2C%22label_seq_id%22%3A162%7D%2C%22allowed%22%3A%5B%22LYS%22%5D%7D%2C%7B%22residue_id%22%3A%7B%22label_asym_id%22%3A%22A%22%2C%22struct_oper_id%22%3A%221%22%2C%22label_seq_id%22%3A193%7D%2C%22allowed%22%3A%5B%22ASP%22%5D%7D%2C%7B%22residue_id%22%3A%7B%22label_asym_id%22%3A%22A%22%2C%22struct_oper_id%22%3A%221%22%2C%22label_seq_id%22%3A219%7D%2C%22allowed%22%3A%5B%22GLU%22%5D%7D%2C%7B%22residue_id%22%3A%7B%22label_asym_id%22%3A%22A%22%2C%22struct_oper_id%22%3A%221%22%2C%22label_seq_id%22%3A245%7D%2C%22allowed%22%3A%5B%22GLU%22%5D%7D%2C%7B%22residue_id%22%3A%7B%22label_asym_id%22%3A%22A%22%2C%22struct_oper_id%22%3A%221%22%2C%22label_seq_id%22%3A295%7D%2C%22allowed%22%3A%5B%22HIS%22%5D%7D%5D%7D%7D%5D%7D%2C%22return_type%22%3A%22assembly%22%2C%22request_options%22%3A%7B%22paginate%22%3A%7B%22start%22%3A0%2C%22rows%22%3A25%7D%2C%22results_content_type%22%3A%5B%22experimental%22%5D%2C%22sort%22%3A%5B%7B%22sort_by%22%3A%22score%22%2C%22direction%22%3A%22desc%22%7D%5D%2C%22scoring_strategy%22%3A%22combined%22%7D%2C%22request_info%22%3A%7B%22query_id%22%3A%226c81b242dc8e3c71064e1b73395f80fb%22%7D%7D)                                                             | 2mnr - Lys:A-162, Asp:A-193, Glu:A-219, Glu:A-245, His:A-295                 | 173              | 160               | 2                 | 177             |
| [Enolase Superfamily (exchanges)](https://www.rcsb.org/search?request=%7B%22query%22%3A%7B%22type%22%3A%22group%22%2C%22logical_operator%22%3A%22and%22%2C%22nodes%22%3A%5B%7B%22type%22%3A%22terminal%22%2C%22service%22%3A%22strucmotif%22%2C%22parameters%22%3A%7B%22value%22%3A%7B%22entry_id%22%3A%222MNR%22%2C%22residue_ids%22%3A%5B%7B%22label_asym_id%22%3A%22A%22%2C%22struct_oper_id%22%3A%221%22%2C%22label_seq_id%22%3A162%7D%2C%7B%22label_asym_id%22%3A%22A%22%2C%22struct_oper_id%22%3A%221%22%2C%22label_seq_id%22%3A193%7D%2C%7B%22label_asym_id%22%3A%22A%22%2C%22struct_oper_id%22%3A%221%22%2C%22label_seq_id%22%3A219%7D%2C%7B%22label_asym_id%22%3A%22A%22%2C%22struct_oper_id%22%3A%221%22%2C%22label_seq_id%22%3A245%7D%2C%7B%22label_asym_id%22%3A%22A%22%2C%22struct_oper_id%22%3A%221%22%2C%22label_seq_id%22%3A295%7D%5D%7D%2C%22rmsd_cutoff%22%3A2%2C%22atom_pairing_scheme%22%3A%22ALL%22%2C%22exchanges%22%3A%5B%7B%22residue_id%22%3A%7B%22label_asym_id%22%3A%22A%22%2C%22struct_oper_id%22%3A%221%22%2C%22label_seq_id%22%3A162%7D%2C%22allowed%22%3A%5B%22LYS%22%2C%22HIS%22%5D%7D%2C%7B%22residue_id%22%3A%7B%22label_asym_id%22%3A%22A%22%2C%22struct_oper_id%22%3A%221%22%2C%22label_seq_id%22%3A193%7D%2C%22allowed%22%3A%5B%22ASP%22%5D%7D%2C%7B%22residue_id%22%3A%7B%22label_asym_id%22%3A%22A%22%2C%22struct_oper_id%22%3A%221%22%2C%22label_seq_id%22%3A219%7D%2C%22allowed%22%3A%5B%22GLU%22%5D%7D%2C%7B%22residue_id%22%3A%7B%22label_asym_id%22%3A%22A%22%2C%22struct_oper_id%22%3A%221%22%2C%22label_seq_id%22%3A245%7D%2C%22allowed%22%3A%5B%22GLU%22%2C%22ASP%22%2C%22ASN%22%5D%7D%2C%7B%22residue_id%22%3A%7B%22label_asym_id%22%3A%22A%22%2C%22struct_oper_id%22%3A%221%22%2C%22label_seq_id%22%3A295%7D%2C%22allowed%22%3A%5B%22HIS%22%2C%22LYS%22%5D%7D%5D%7D%7D%5D%7D%2C%22return_type%22%3A%22assembly%22%2C%22request_options%22%3A%7B%22paginate%22%3A%7B%22start%22%3A0%2C%22rows%22%3A25%7D%2C%22scoring_strategy%22%3A%22combined%22%2C%22sort%22%3A%5B%7B%22sort_by%22%3A%22score%22%2C%22direction%22%3A%22desc%22%7D%5D%2C%22results_content_type%22%3A%5B%22experimental%22%5D%7D%2C%22request_info%22%3A%7B%22query_id%22%3A%2200dbfaf8cae58f2b3d17521c6a8fc613%22%7D%7D) | 2mnr - Lys/His:A-162, Asp:A-193, Glu:A-219, Glu/Asp/Asn:A-245, His/Lys:A-295 | 183              | 980               | 5                 | 1,005           |
| [RNA G-Quadruplex](https://www.rcsb.org/search?request=%7B%22query%22%3A%7B%22type%22%3A%22group%22%2C%22logical_operator%22%3A%22and%22%2C%22nodes%22%3A%5B%7B%22type%22%3A%22terminal%22%2C%22service%22%3A%22strucmotif%22%2C%22parameters%22%3A%7B%22value%22%3A%7B%22entry_id%22%3A%223IBK%22%2C%22residue_ids%22%3A%5B%7B%22label_asym_id%22%3A%22A%22%2C%22struct_oper_id%22%3A%221%22%2C%22label_seq_id%22%3A4%7D%2C%7B%22label_asym_id%22%3A%22A%22%2C%22struct_oper_id%22%3A%221%22%2C%22label_seq_id%22%3A10%7D%2C%7B%22label_asym_id%22%3A%22B%22%2C%22struct_oper_id%22%3A%221%22%2C%22label_seq_id%22%3A4%7D%2C%7B%22label_asym_id%22%3A%22B%22%2C%22struct_oper_id%22%3A%221%22%2C%22label_seq_id%22%3A10%7D%5D%7D%2C%22rmsd_cutoff%22%3A2%2C%22atom_pairing_scheme%22%3A%22ALL%22%2C%22exchanges%22%3A%5B%7B%22residue_id%22%3A%7B%22label_asym_id%22%3A%22A%22%2C%22struct_oper_id%22%3A%221%22%2C%22label_seq_id%22%3A4%7D%2C%22allowed%22%3A%5B%22G%22%5D%7D%2C%7B%22residue_id%22%3A%7B%22label_asym_id%22%3A%22A%22%2C%22struct_oper_id%22%3A%221%22%2C%22label_seq_id%22%3A10%7D%2C%22allowed%22%3A%5B%22G%22%5D%7D%2C%7B%22residue_id%22%3A%7B%22label_asym_id%22%3A%22B%22%2C%22struct_oper_id%22%3A%221%22%2C%22label_seq_id%22%3A4%7D%2C%22allowed%22%3A%5B%22G%22%5D%7D%2C%7B%22residue_id%22%3A%7B%22label_asym_id%22%3A%22B%22%2C%22struct_oper_id%22%3A%221%22%2C%22label_seq_id%22%3A10%7D%2C%22allowed%22%3A%5B%22G%22%5D%7D%5D%7D%7D%5D%7D%2C%22return_type%22%3A%22assembly%22%2C%22request_options%22%3A%7B%22pager%22%3A%7B%22start%22%3A0%2C%22rows%22%3A25%7D%2C%22scoring_strategy%22%3A%22combined%22%2C%22sort%22%3A%5B%7B%22sort_by%22%3A%22score%22%2C%22direction%22%3A%22desc%22%7D%5D%7D%2C%22request_info%22%3A%7B%22src%22%3A%22ui%22%2C%22query_id%22%3A%22491241b8c37e9f6f50b3140cd555c1bf%22%7D%7D)                                                                                                                                                                                                                                                                                                                                                                                       | 3ibk - G:A-4, G:A-10, G:B-4, G:B-10                                          | 36               | 999               | 96                | 1,112           |

### Including Computed Structure Models
| Motif                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | Definition                                                                   | Found Assemblies | 'Paths' Time [ms] | 'Score' Time [ms] | Total Time [ms] |
|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------|------------------|-------------------|-------------------|-----------------|
| [Serine Protease](https://www.rcsb.org/search?request=%7B%22query%22%3A%7B%22type%22%3A%22group%22%2C%22logical_operator%22%3A%22and%22%2C%22nodes%22%3A%5B%7B%22type%22%3A%22terminal%22%2C%22service%22%3A%22strucmotif%22%2C%22parameters%22%3A%7B%22value%22%3A%7B%22residue_ids%22%3A%5B%7B%22label_asym_id%22%3A%22B%22%2C%22struct_oper_id%22%3A%221%22%2C%22label_seq_id%22%3A42%7D%2C%7B%22label_asym_id%22%3A%22B%22%2C%22struct_oper_id%22%3A%221%22%2C%22label_seq_id%22%3A87%7D%2C%7B%22label_asym_id%22%3A%22C%22%2C%22struct_oper_id%22%3A%221%22%2C%22label_seq_id%22%3A47%7D%5D%2C%22entry_id%22%3A%224CHA%22%7D%2C%22rmsd_cutoff%22%3A2%2C%22atom_pairing_scheme%22%3A%22ALL%22%2C%22exchanges%22%3A%5B%7B%22residue_id%22%3A%7B%22label_asym_id%22%3A%22B%22%2C%22struct_oper_id%22%3A%221%22%2C%22label_seq_id%22%3A42%7D%2C%22allowed%22%3A%5B%22HIS%22%5D%7D%2C%7B%22residue_id%22%3A%7B%22label_asym_id%22%3A%22B%22%2C%22struct_oper_id%22%3A%221%22%2C%22label_seq_id%22%3A87%7D%2C%22allowed%22%3A%5B%22ASP%22%5D%7D%2C%7B%22residue_id%22%3A%7B%22label_asym_id%22%3A%22C%22%2C%22struct_oper_id%22%3A%221%22%2C%22label_seq_id%22%3A47%7D%2C%22allowed%22%3A%5B%22SER%22%5D%7D%5D%7D%7D%5D%7D%2C%22return_type%22%3A%22assembly%22%2C%22request_options%22%3A%7B%22results_content_type%22%3A%5B%22computational%22%2C%22experimental%22%5D%2C%22paginate%22%3A%7B%22start%22%3A0%2C%22rows%22%3A25%7D%2C%22sort%22%3A%5B%7B%22sort_by%22%3A%22score%22%2C%22direction%22%3A%22desc%22%7D%5D%2C%22scoring_strategy%22%3A%22combined%22%7D%2C%22request_info%22%3A%7B%22query_id%22%3A%223406c0c06a768c5a8f8604e328a10c22%22%7D%7D)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | 4cha - His:B-42, Asp:B-87, Ser:C-47                                          | 9,631            | 3,069             | 77                | 3,182           |
| [Aminopeptidase](https://www.rcsb.org/search?request=%7B%22query%22%3A%7B%22type%22%3A%22group%22%2C%22logical_operator%22%3A%22and%22%2C%22nodes%22%3A%5B%7B%22type%22%3A%22terminal%22%2C%22service%22%3A%22strucmotif%22%2C%22parameters%22%3A%7B%22value%22%3A%7B%22residue_ids%22%3A%5B%7B%22label_asym_id%22%3A%22A%22%2C%22struct_oper_id%22%3A%221%22%2C%22label_seq_id%22%3A250%7D%2C%7B%22label_asym_id%22%3A%22A%22%2C%22struct_oper_id%22%3A%221%22%2C%22label_seq_id%22%3A255%7D%2C%7B%22label_asym_id%22%3A%22A%22%2C%22struct_oper_id%22%3A%221%22%2C%22label_seq_id%22%3A273%7D%2C%7B%22label_asym_id%22%3A%22A%22%2C%22struct_oper_id%22%3A%221%22%2C%22label_seq_id%22%3A332%7D%2C%7B%22label_asym_id%22%3A%22A%22%2C%22struct_oper_id%22%3A%221%22%2C%22label_seq_id%22%3A334%7D%5D%2C%22entry_id%22%3A%221LAP%22%7D%2C%22rmsd_cutoff%22%3A2%2C%22atom_pairing_scheme%22%3A%22ALL%22%2C%22exchanges%22%3A%5B%7B%22residue_id%22%3A%7B%22label_asym_id%22%3A%22A%22%2C%22struct_oper_id%22%3A%221%22%2C%22label_seq_id%22%3A250%7D%2C%22allowed%22%3A%5B%22LYS%22%5D%7D%2C%7B%22residue_id%22%3A%7B%22label_asym_id%22%3A%22A%22%2C%22struct_oper_id%22%3A%221%22%2C%22label_seq_id%22%3A255%7D%2C%22allowed%22%3A%5B%22ASP%22%5D%7D%2C%7B%22residue_id%22%3A%7B%22label_asym_id%22%3A%22A%22%2C%22struct_oper_id%22%3A%221%22%2C%22label_seq_id%22%3A273%7D%2C%22allowed%22%3A%5B%22ASP%22%5D%7D%2C%7B%22residue_id%22%3A%7B%22label_asym_id%22%3A%22A%22%2C%22struct_oper_id%22%3A%221%22%2C%22label_seq_id%22%3A332%7D%2C%22allowed%22%3A%5B%22ASP%22%5D%7D%2C%7B%22residue_id%22%3A%7B%22label_asym_id%22%3A%22A%22%2C%22struct_oper_id%22%3A%221%22%2C%22label_seq_id%22%3A334%7D%2C%22allowed%22%3A%5B%22GLU%22%5D%7D%5D%7D%7D%5D%7D%2C%22return_type%22%3A%22assembly%22%2C%22request_options%22%3A%7B%22results_content_type%22%3A%5B%22computational%22%2C%22experimental%22%5D%2C%22paginate%22%3A%7B%22start%22%3A0%2C%22rows%22%3A25%7D%2C%22sort%22%3A%5B%7B%22sort_by%22%3A%22score%22%2C%22direction%22%3A%22desc%22%7D%5D%2C%22scoring_strategy%22%3A%22combined%22%7D%2C%22request_info%22%3A%7B%22query_id%22%3A%22e769cc7ce36a826a8320ebb087062b7a%22%7D%7D)                                                                  | 1lap - Lys:A-250, Asp:A-255, Asp:A-273, Asp:A-332, Glu:A-334                 | 630              | 2,298             | 5                 | 2,322           |
| [Zinc Fingers](https://www.rcsb.org/search?request=%7B%22query%22%3A%7B%22type%22%3A%22group%22%2C%22logical_operator%22%3A%22and%22%2C%22nodes%22%3A%5B%7B%22type%22%3A%22terminal%22%2C%22service%22%3A%22strucmotif%22%2C%22parameters%22%3A%7B%22value%22%3A%7B%22residue_ids%22%3A%5B%7B%22label_asym_id%22%3A%22F%22%2C%22struct_oper_id%22%3A%221%22%2C%22label_seq_id%22%3A7%7D%2C%7B%22label_asym_id%22%3A%22F%22%2C%22struct_oper_id%22%3A%221%22%2C%22label_seq_id%22%3A25%7D%2C%7B%22label_asym_id%22%3A%22F%22%2C%22struct_oper_id%22%3A%221%22%2C%22label_seq_id%22%3A29%7D%5D%2C%22entry_id%22%3A%221G2F%22%7D%2C%22rmsd_cutoff%22%3A2%2C%22atom_pairing_scheme%22%3A%22ALL%22%2C%22exchanges%22%3A%5B%7B%22residue_id%22%3A%7B%22label_asym_id%22%3A%22F%22%2C%22struct_oper_id%22%3A%221%22%2C%22label_seq_id%22%3A7%7D%2C%22allowed%22%3A%5B%22CYS%22%5D%7D%2C%7B%22residue_id%22%3A%7B%22label_asym_id%22%3A%22F%22%2C%22struct_oper_id%22%3A%221%22%2C%22label_seq_id%22%3A25%7D%2C%22allowed%22%3A%5B%22HIS%22%5D%7D%2C%7B%22residue_id%22%3A%7B%22label_asym_id%22%3A%22F%22%2C%22struct_oper_id%22%3A%221%22%2C%22label_seq_id%22%3A29%7D%2C%22allowed%22%3A%5B%22HIS%22%5D%7D%5D%7D%7D%5D%7D%2C%22return_type%22%3A%22assembly%22%2C%22request_options%22%3A%7B%22results_content_type%22%3A%5B%22computational%22%2C%22experimental%22%5D%2C%22paginate%22%3A%7B%22start%22%3A0%2C%22rows%22%3A25%7D%2C%22sort%22%3A%5B%7B%22sort_by%22%3A%22score%22%2C%22direction%22%3A%22desc%22%7D%5D%2C%22scoring_strategy%22%3A%22combined%22%7D%2C%22request_info%22%3A%7B%22query_id%22%3A%22a14d7f01296fea7d9f16838adaf1fe93%22%7D%7D)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | 1g2f - Cys:F-7 His:F-25 His:F-29                                             | 7,596            | 440               | 341               | 840             |
| [Enolase Superfamily](https://www.rcsb.org/search?request=%7B%22query%22%3A%7B%22type%22%3A%22group%22%2C%22logical_operator%22%3A%22and%22%2C%22nodes%22%3A%5B%7B%22type%22%3A%22terminal%22%2C%22service%22%3A%22strucmotif%22%2C%22parameters%22%3A%7B%22value%22%3A%7B%22residue_ids%22%3A%5B%7B%22label_asym_id%22%3A%22A%22%2C%22struct_oper_id%22%3A%221%22%2C%22label_seq_id%22%3A162%7D%2C%7B%22label_asym_id%22%3A%22A%22%2C%22struct_oper_id%22%3A%221%22%2C%22label_seq_id%22%3A193%7D%2C%7B%22label_asym_id%22%3A%22A%22%2C%22struct_oper_id%22%3A%221%22%2C%22label_seq_id%22%3A219%7D%2C%7B%22label_asym_id%22%3A%22A%22%2C%22struct_oper_id%22%3A%221%22%2C%22label_seq_id%22%3A245%7D%2C%7B%22label_asym_id%22%3A%22A%22%2C%22struct_oper_id%22%3A%221%22%2C%22label_seq_id%22%3A295%7D%5D%2C%22entry_id%22%3A%222MNR%22%7D%2C%22rmsd_cutoff%22%3A2%2C%22atom_pairing_scheme%22%3A%22ALL%22%2C%22exchanges%22%3A%5B%7B%22residue_id%22%3A%7B%22label_asym_id%22%3A%22A%22%2C%22struct_oper_id%22%3A%221%22%2C%22label_seq_id%22%3A162%7D%2C%22allowed%22%3A%5B%22LYS%22%5D%7D%2C%7B%22residue_id%22%3A%7B%22label_asym_id%22%3A%22A%22%2C%22struct_oper_id%22%3A%221%22%2C%22label_seq_id%22%3A193%7D%2C%22allowed%22%3A%5B%22ASP%22%5D%7D%2C%7B%22residue_id%22%3A%7B%22label_asym_id%22%3A%22A%22%2C%22struct_oper_id%22%3A%221%22%2C%22label_seq_id%22%3A219%7D%2C%22allowed%22%3A%5B%22GLU%22%5D%7D%2C%7B%22residue_id%22%3A%7B%22label_asym_id%22%3A%22A%22%2C%22struct_oper_id%22%3A%221%22%2C%22label_seq_id%22%3A245%7D%2C%22allowed%22%3A%5B%22GLU%22%5D%7D%2C%7B%22residue_id%22%3A%7B%22label_asym_id%22%3A%22A%22%2C%22struct_oper_id%22%3A%221%22%2C%22label_seq_id%22%3A295%7D%2C%22allowed%22%3A%5B%22HIS%22%5D%7D%5D%7D%7D%5D%7D%2C%22return_type%22%3A%22assembly%22%2C%22request_options%22%3A%7B%22results_content_type%22%3A%5B%22computational%22%2C%22experimental%22%5D%2C%22paginate%22%3A%7B%22start%22%3A0%2C%22rows%22%3A25%7D%2C%22sort%22%3A%5B%7B%22sort_by%22%3A%22score%22%2C%22direction%22%3A%22desc%22%7D%5D%2C%22scoring_strategy%22%3A%22combined%22%7D%2C%22request_info%22%3A%7B%22query_id%22%3A%222e1cf4c9f3f1abf6a71094a5108060d3%22%7D%7D)                                                             | 2mnr - Lys:A-162, Asp:A-193, Glu:A-219, Glu:A-245, His:A-295                 | 302              | 346               | 3                 | 368             |
| [Enolase Superfamily (exchanges)](https://www.rcsb.org/search?request=%7B%22query%22%3A%7B%22type%22%3A%22group%22%2C%22logical_operator%22%3A%22and%22%2C%22nodes%22%3A%5B%7B%22type%22%3A%22terminal%22%2C%22service%22%3A%22strucmotif%22%2C%22parameters%22%3A%7B%22value%22%3A%7B%22residue_ids%22%3A%5B%7B%22label_asym_id%22%3A%22A%22%2C%22struct_oper_id%22%3A%221%22%2C%22label_seq_id%22%3A162%7D%2C%7B%22label_asym_id%22%3A%22A%22%2C%22struct_oper_id%22%3A%221%22%2C%22label_seq_id%22%3A193%7D%2C%7B%22label_asym_id%22%3A%22A%22%2C%22struct_oper_id%22%3A%221%22%2C%22label_seq_id%22%3A219%7D%2C%7B%22label_asym_id%22%3A%22A%22%2C%22struct_oper_id%22%3A%221%22%2C%22label_seq_id%22%3A245%7D%2C%7B%22label_asym_id%22%3A%22A%22%2C%22struct_oper_id%22%3A%221%22%2C%22label_seq_id%22%3A295%7D%5D%2C%22entry_id%22%3A%222MNR%22%7D%2C%22rmsd_cutoff%22%3A2%2C%22atom_pairing_scheme%22%3A%22ALL%22%2C%22exchanges%22%3A%5B%7B%22residue_id%22%3A%7B%22label_asym_id%22%3A%22A%22%2C%22struct_oper_id%22%3A%221%22%2C%22label_seq_id%22%3A162%7D%2C%22allowed%22%3A%5B%22LYS%22%2C%22HIS%22%5D%7D%2C%7B%22residue_id%22%3A%7B%22label_asym_id%22%3A%22A%22%2C%22struct_oper_id%22%3A%221%22%2C%22label_seq_id%22%3A193%7D%2C%22allowed%22%3A%5B%22ASP%22%5D%7D%2C%7B%22residue_id%22%3A%7B%22label_asym_id%22%3A%22A%22%2C%22struct_oper_id%22%3A%221%22%2C%22label_seq_id%22%3A219%7D%2C%22allowed%22%3A%5B%22GLU%22%5D%7D%2C%7B%22residue_id%22%3A%7B%22label_asym_id%22%3A%22A%22%2C%22struct_oper_id%22%3A%221%22%2C%22label_seq_id%22%3A245%7D%2C%22allowed%22%3A%5B%22GLU%22%2C%22ASP%22%2C%22ASN%22%5D%7D%2C%7B%22residue_id%22%3A%7B%22label_asym_id%22%3A%22A%22%2C%22struct_oper_id%22%3A%221%22%2C%22label_seq_id%22%3A295%7D%2C%22allowed%22%3A%5B%22HIS%22%2C%22LYS%22%5D%7D%5D%7D%7D%5D%7D%2C%22return_type%22%3A%22assembly%22%2C%22request_options%22%3A%7B%22results_content_type%22%3A%5B%22computational%22%2C%22experimental%22%5D%2C%22paginate%22%3A%7B%22start%22%3A0%2C%22rows%22%3A25%7D%2C%22sort%22%3A%5B%7B%22sort_by%22%3A%22score%22%2C%22direction%22%3A%22desc%22%7D%5D%2C%22scoring_strategy%22%3A%22combined%22%7D%2C%22request_info%22%3A%7B%22query_id%22%3A%222884d65d537d1d4383f0aed6ce79cd08%22%7D%7D) | 2mnr - Lys/His:A-162, Asp:A-193, Glu:A-219, Glu/Asp/Asn:A-245, His/Lys:A-295 | 315              | 3,123             | 10                | 3,150           |
| [RNA G-Quadruplex](https://www.rcsb.org/search?request=%7B%22query%22%3A%7B%22type%22%3A%22group%22%2C%22logical_operator%22%3A%22and%22%2C%22nodes%22%3A%5B%7B%22type%22%3A%22terminal%22%2C%22service%22%3A%22strucmotif%22%2C%22parameters%22%3A%7B%22value%22%3A%7B%22residue_ids%22%3A%5B%7B%22label_asym_id%22%3A%22A%22%2C%22struct_oper_id%22%3A%221%22%2C%22label_seq_id%22%3A4%7D%2C%7B%22label_asym_id%22%3A%22A%22%2C%22struct_oper_id%22%3A%221%22%2C%22label_seq_id%22%3A10%7D%2C%7B%22label_asym_id%22%3A%22B%22%2C%22struct_oper_id%22%3A%221%22%2C%22label_seq_id%22%3A4%7D%2C%7B%22label_asym_id%22%3A%22B%22%2C%22struct_oper_id%22%3A%221%22%2C%22label_seq_id%22%3A10%7D%5D%2C%22entry_id%22%3A%223IBK%22%7D%2C%22rmsd_cutoff%22%3A2%2C%22atom_pairing_scheme%22%3A%22ALL%22%2C%22exchanges%22%3A%5B%7B%22residue_id%22%3A%7B%22label_asym_id%22%3A%22A%22%2C%22struct_oper_id%22%3A%221%22%2C%22label_seq_id%22%3A4%7D%2C%22allowed%22%3A%5B%22G%22%5D%7D%2C%7B%22residue_id%22%3A%7B%22label_asym_id%22%3A%22A%22%2C%22struct_oper_id%22%3A%221%22%2C%22label_seq_id%22%3A10%7D%2C%22allowed%22%3A%5B%22G%22%5D%7D%2C%7B%22residue_id%22%3A%7B%22label_asym_id%22%3A%22B%22%2C%22struct_oper_id%22%3A%221%22%2C%22label_seq_id%22%3A4%7D%2C%22allowed%22%3A%5B%22G%22%5D%7D%2C%7B%22residue_id%22%3A%7B%22label_asym_id%22%3A%22B%22%2C%22struct_oper_id%22%3A%221%22%2C%22label_seq_id%22%3A10%7D%2C%22allowed%22%3A%5B%22G%22%5D%7D%5D%7D%7D%5D%7D%2C%22return_type%22%3A%22assembly%22%2C%22request_options%22%3A%7B%22results_content_type%22%3A%5B%22computational%22%2C%22experimental%22%5D%2C%22paginate%22%3A%7B%22start%22%3A0%2C%22rows%22%3A25%7D%2C%22sort%22%3A%5B%7B%22sort_by%22%3A%22score%22%2C%22direction%22%3A%22desc%22%7D%5D%2C%22scoring_strategy%22%3A%22combined%22%7D%2C%22request_info%22%3A%7B%22query_id%22%3A%22a7e65799ffd02b594b1b2e46025d64f3%22%7D%7D)                                                                                                                                                                                                                                                                                                                                                   | 3ibk - G:A-4, G:A-10, G:B-4, G:B-10                                          | 40               | 1,043             | 93                | 1,154           |

Search for all assemblies that contain hits with an RMSD <2 Å.
'Paths' refers to the time spent on inverted index operations, which identify all candidate structures that contain the 
motif.
'Score' refers to the time spent on aligning candidate structures to the query and computing RMSD values.

AlphaFold data ignores unreliable regions with pLDDT <70. The 2nd run also considers structures that lack assembly 
information, thus the count for the RNA G-Quadruplex motif increased despite AlphaFold structure not containing any RNA.

## Features
- nucleotide support
- inter-chain & assembly support
- position-specific exchanges
- modified residues
- support for computed structure models, like from AlphaFold
- detect motifs in a structure of interest

## Getting Started with a Dependency
strucmotif-search is distributed by maven and supports Java 11+. To get started, append your `pom.xml` by:
```xml
<dependency>
  <groupId>org.rcsb</groupId>
  <artifactId>strucmotif-search</artifactId>
  <version>0.18.1</version>
</dependency>
```

## Getting Started by Cloning
An alternative way to use the library is cloning this repository and building the corresponding Maven modules.

## Search for Similar Structures by A Single Motif
The `Strucmotif` class provides a fluent API to process structural motif queries.

```java
Strucmotif.searchForStructures()
        // several ways can be used to define the query motif - e.g., specify a PDB entry id
        .defineByPdbIdAndSelection("4cha",
                // and a collection of sequence positions to extract residues to use as motif
                List.of(new LabelSelection("B", "1", 42), // HIS
                        new LabelSelection("B", "1", 87), // ASP
                        new LabelSelection("C", "1", 47))) // SER
        .rmsdCutoff(1.0)
        .buildParameters()
        .buildContext()
        .run()
        .getHits()
        .stream()
        .map(hit -> hit.structureIdentifier() + "_" + 
                    hit.assemblyIdentifier() + " @ " + 
                    hit.labelSelections() + " - RMSD: " +
                    hit.rmsd())
        .forEach(System.out::println);
```

## Detect if a Structure Contains Motifs of Interest
This process can also be reversed to detect whether a structure of unknown function contains characteristic motifs.

```java
// acquire a collection of motifs to screen for
Set<EnrichedMotifDefinition> motifs = Strucmotif.getMotifDefinitionRegistry().getEnrichedMotifDefinitions();

Strucmotif.detectMotifs()
        .defineByPdbIdAndAssemblyId("2mnr", "1")
        .withMotifs(motifs)
        .rmsdCutoff(1.0)
        .buildParameters()
        .buildContext()
        .run()
        .getHits()
        .stream()
        .map(hit -> hit.motifIdentifier() + " @ " +
                    hit.labelSelections() + " - RMSD: " +
                    hit.rmsd())
        .forEach(System.out::println);
```

## Configuration
| Property                | Action                                                       | Default Value/Behavior |
|-------------------------|--------------------------------------------------------------|------------------------|
| `ccd-url`               | URL to the chemical component dictionary                     | wwPDB                  |
| `decimal-places-score`  | Number of decimal places reported for scores                 | `2`                    |
| `decimal-places-matrix` | Number of decimal places reported in transformation matrices | `3`                    |
| `in-memory-strategy`    | Preload structure data for increased performance?            | `off`                  |
| `loading-chunk-size`    | Batch size when holding structure data in memory             | `250,000`              |
| `max-results`           | Maximum number of results that will be returned              | `50,000`               |
| `max-motif-size`        | Maximum number of residues that may define a motif           | `10`                   |
| `per-query-threads`     | Number of worker threads per query                           | available processors   |
| `query-timeout`         | Interrupt queries after `n` milliseconds                     | `none`                 |
| `root-path`             | Path where data files will be written                        | `/opt/data/`           |

Configure by placing your `application.properties` on the classpath. All properties specific to this project must be 
prefixed with `strucmotif.`.

## Index Structure Data and Run Updates
You will need to process your corpus of structure data before using the service. This will create an optimized version of
all structure files and add them to an inverted index that allows efficient searching.

Details can be found in:
[UPDATE.md](https://github.com/rcsb/strucmotif-search/blob/master/strucmotif-search-update/UPDATE.md)

## Implementation Details
### Addressing Atoms
Two address schemes exist. `LabelSelection` is a high-level, object-based way of referencing individual residues. It 
uses a combination of mmCIF properties, namely `label_asym_id`, `struct_oper_id`, and `label_seq_id`:
```java
LabelSelection ref = new LabelSelection("A", "1", 123);
```

Internally, access is facilitated using 32-bit unsigned primitive encoded integers. It doesn't follow any particular 
layout rather, all encountered residues are addressed by their index. Chain boundaries are ignored. Operations required
for assemblies are honored as they occur in the source file and merely increment the counter.
Additional work is done to preserve information on chains and assemblies. Chain and operator names as well as boundaries
are stored in memory and can be used to reconstruct `LabelSelection` instances if needed.

## Related Projects
- [ciftools-java](https://github.com/rcsb/ciftools-java): mmCIF parsing and BinaryCIF implementation
- [ffindex-java](https://github.com/rcsb/ffindex-java): bundle large amounts of small files together
- [rcsb-molstar](https://github.com/molstar/rcsb-molstar): define motifs in 3D and visualize results

## Publication
Bittrich S, Burley SK, Rose AS (2020) Real-time structural motif searching in proteins using an inverted index strategy. PLoS Comput Biol 16(12): e1008502. https://doi.org/10.1371/journal.pcbi.1008502
